{"ast":null,"code":"import queryString from\"query-string\";import{useEffect}from\"react\";import{useLoaderData,useSearchParams}from\"react-router-dom\";import{SearchBar}from\"./searchBar\";import{PetCard}from\"./petCard\";import{Pagination}from\"./pagination\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const PetSearchPage=()=>{let[searchParams,setSearchParams]=useSearchParams();const pets=useLoaderData();useEffect(()=>{setSearchParams(searchParams);},[searchParams,setSearchParams]);const clearQuery=()=>{return setSearchParams({});};//Pagination data.\nconst resultsCount=pets.totalPetsResults;const limit=Number(searchParams.get(\"limit\")||6);const page=Number(searchParams.get(\"page\")||1);const pages=Math.trunc(Math.ceil(resultsCount/limit));let pageList=[];if(resultsCount){pageList=[...Array(pages+1).keys()].slice(1);}const next=page<pages?page+1:page;const previous=page>1?page-1:page;const paginationQuery=e=>{const{name:key,id:value}=e.currentTarget;let parsed=queryString.parse(window.location.search);if(!parsed[key]){//No key present in current search params, set search params.\nparsed[key]=value;}else if(value!==parsed[key]){//Key present but value is new in current search params,\n//update params value.\ndelete parsed[key];parsed[key]=value;}const stringified=queryString.stringify(parsed);setSearchParams(stringified);window.scrollTo({top:0,behavior:\"smooth\"});};const sortQuery=e=>{const{name:key,id:value}=e.currentTarget;let parsed=queryString.parse(window.location.search);if(!parsed[key]){//No key present in current search params, set search params.\nparsed[key]=value;}else if(key in parsed&&value===parsed[key]){//Key and value match current search params, delete search params from query.\ndelete parsed[key];}else if(value!==parsed[key]){//Key present but value is new in current search params,\n//update params value.\nparsed[key]=value;}delete parsed[\"page\"];const stringified=queryString.stringify(parsed);setSearchParams(stringified);};const speciesQuery=e=>{const{name:key,id:value}=e.currentTarget;let parsed=queryString.parse(window.location.search);if(!Array.isArray(parsed.species)){parsed.species=[parsed.species];}if(!parsed[key]){//No key present in current search params, append sort search params.\nparsed[key]=value;}else if(key in parsed&&value===parsed[key]){//Key and value match current sort search params, remove sort search params.\ndelete parsed[key];}else if(!parsed.species.includes(value)){parsed.species.push(value);}else if(parsed.species.includes(value)){parsed.species=parsed.species.filter(element=>{return element!==value;});}delete parsed[\"page\"];const stringified=queryString.stringify(parsed);setSearchParams(stringified);};return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4\",children:[/*#__PURE__*/_jsx(SearchBar,{clearQuery:clearQuery,sortQuery:sortQuery,speciesQuery:speciesQuery}),/*#__PURE__*/_jsx(\"ul\",{className:\"flex flex-row flex-wrap justify-evenly gap-x-1 gap-y-7 my-5\",children:pets.data.length!==0?pets.data.map(pet=>/*#__PURE__*/_jsx(PetCard,{species:pet.species,_id:pet._id,name:pet.name,fee:pet.fee,image:pet.image,gender:pet.gender,age:pet.age,dateAddedToSite:pet.dateAddedToSite},pet._id)):/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col justify-center my-4\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-center mb-4\",children:\"Woof... We're having trouble finding pets right now.\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex my-20\",children:/*#__PURE__*/_jsx(Pagination,{pageList:pageList,next:next,previous:previous,paginationQuery:paginationQuery})})]});};","map":{"version":3,"names":["queryString","useEffect","useLoaderData","useSearchParams","SearchBar","PetCard","Pagination","jsx","_jsx","jsxs","_jsxs","PetSearchPage","searchParams","setSearchParams","pets","clearQuery","resultsCount","totalPetsResults","limit","Number","get","page","pages","Math","trunc","ceil","pageList","Array","keys","slice","next","previous","paginationQuery","e","name","key","id","value","currentTarget","parsed","parse","window","location","search","stringified","stringify","scrollTo","top","behavior","sortQuery","speciesQuery","isArray","species","includes","push","filter","element","className","children","data","length","map","pet","_id","fee","image","gender","age","dateAddedToSite"],"sources":["E:/MERN/backend/client/src/components/petSearch/petSearchPage.tsx"],"sourcesContent":["import queryString from \"query-string\";\nimport { useEffect } from \"react\";\nimport { useLoaderData, useSearchParams } from \"react-router-dom\";\nimport { SearchBar } from \"./searchBar\";\nimport { PetCard } from \"./petCard\";\nimport { Pagination } from \"./pagination\";\n\nexport const PetSearchPage: Function = () => {\n  let [searchParams, setSearchParams] = useSearchParams();\n\n  const pets = useLoaderData() as PetData;\n\n  useEffect(() => {\n    setSearchParams(searchParams);\n  }, [searchParams, setSearchParams]);\n\n  const clearQuery: React.MouseEventHandler = () => {\n    return setSearchParams({});\n  };\n\n  //Pagination data.\n  const resultsCount = pets.totalPetsResults;\n  const limit: number = Number(searchParams.get(\"limit\") || 6);\n  const page: number = Number(searchParams.get(\"page\") || 1);\n  const pages: number = Math.trunc(Math.ceil(resultsCount / limit));\n  let pageList: number[] = [];\n  if (resultsCount) {\n    pageList = [...Array(pages + 1).keys()].slice(1);\n  }\n  const next = page < pages ? page + 1 : page;\n  const previous = page > 1 ? page - 1 : page;\n\n  const paginationQuery = (e: React.MouseEvent<HTMLButtonElement>) => {\n    const { name: key, id: value } = e.currentTarget as HTMLButtonElement;\n    let parsed = queryString.parse(window.location.search);\n\n    if (!parsed[key]) {\n      //No key present in current search params, set search params.\n      parsed[key] = value;\n    } else if (value !== parsed[key]) {\n      //Key present but value is new in current search params,\n      //update params value.\n      delete parsed[key];\n      parsed[key] = value;\n    }\n\n    const stringified = queryString.stringify(parsed);\n    setSearchParams(stringified);\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  };\n\n  const sortQuery = (e: React.MouseEvent<HTMLButtonElement>) => {\n    const { name: key, id: value } = e.currentTarget as HTMLButtonElement;\n    let parsed = queryString.parse(window.location.search);\n\n    if (!parsed[key]) {\n      //No key present in current search params, set search params.\n      parsed[key] = value;\n    } else if (key in parsed && value === parsed[key]) {\n      //Key and value match current search params, delete search params from query.\n      delete parsed[key];\n    } else if (value !== parsed[key]) {\n      //Key present but value is new in current search params,\n      //update params value.\n      parsed[key] = value;\n    }\n    delete parsed[\"page\"];\n\n    const stringified = queryString.stringify(parsed);\n    setSearchParams(stringified);\n  };\n\n  const speciesQuery = (e: React.MouseEvent<HTMLButtonElement>) => {\n    const { name: key, id: value } = e.currentTarget as HTMLButtonElement;\n    let parsed = queryString.parse(window.location.search);\n\n    if (!Array.isArray(parsed.species)) {\n      parsed.species = [parsed.species];\n    }\n\n    if (!parsed[key]) {\n      //No key present in current search params, append sort search params.\n      parsed[key] = value;\n    } else if (key in parsed && value === parsed[key]) {\n      //Key and value match current sort search params, remove sort search params.\n      delete parsed[key];\n    } else if (!parsed.species.includes(value)) {\n      parsed.species.push(value);\n    } else if (parsed.species.includes(value)) {\n      parsed.species = parsed.species!.filter((element: any) => {\n        return element !== value;\n      });\n    }\n    delete parsed[\"page\"];\n\n    const stringified = queryString.stringify(parsed);\n    setSearchParams(stringified);\n  };\n\n  return (\n    <div className={\"container mx-auto px-4\"}>\n      <SearchBar\n        clearQuery={clearQuery}\n        sortQuery={sortQuery}\n        speciesQuery={speciesQuery}\n      />\n\n      <ul className=\"flex flex-row flex-wrap justify-evenly gap-x-1 gap-y-7 my-5\">\n        {pets.data.length !== 0 ? (\n          pets.data.map((pet: PetCard) => (\n            <PetCard\n              key={pet._id}\n              species={pet.species}\n              _id={pet._id}\n              name={pet.name}\n              fee={pet.fee}\n              image={pet.image}\n              gender={pet.gender}\n              age={pet.age}\n              dateAddedToSite={pet.dateAddedToSite}\n            />\n          ))\n        ) : (\n          <div className=\"flex flex-col justify-center my-4\">\n            <h3 className=\"text-center mb-4\">\n              Woof... We're having trouble finding pets right now.\n            </h3>\n          </div>\n        )}\n      </ul>\n\n      <div className=\"flex my-20\">\n        <Pagination\n          pageList={pageList}\n          next={next}\n          previous={previous}\n          paginationQuery={paginationQuery}\n        />\n      </div>\n    </div>\n  );\n};\n"],"mappings":"AAAA,MAAO,CAAAA,WAAW,KAAM,cAAc,CACtC,OAASC,SAAS,KAAQ,OAAO,CACjC,OAASC,aAAa,CAAEC,eAAe,KAAQ,kBAAkB,CACjE,OAASC,SAAS,KAAQ,aAAa,CACvC,OAASC,OAAO,KAAQ,WAAW,CACnC,OAASC,UAAU,KAAQ,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE1C,MAAO,MAAM,CAAAC,aAAuB,CAAGA,CAAA,GAAM,CAC3C,GAAI,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGV,eAAe,CAAC,CAAC,CAEvD,KAAM,CAAAW,IAAI,CAAGZ,aAAa,CAAC,CAAY,CAEvCD,SAAS,CAAC,IAAM,CACdY,eAAe,CAACD,YAAY,CAAC,CAC/B,CAAC,CAAE,CAACA,YAAY,CAAEC,eAAe,CAAC,CAAC,CAEnC,KAAM,CAAAE,UAAmC,CAAGA,CAAA,GAAM,CAChD,MAAO,CAAAF,eAAe,CAAC,CAAC,CAAC,CAAC,CAC5B,CAAC,CAED;AACA,KAAM,CAAAG,YAAY,CAAGF,IAAI,CAACG,gBAAgB,CAC1C,KAAM,CAAAC,KAAa,CAAGC,MAAM,CAACP,YAAY,CAACQ,GAAG,CAAC,OAAO,CAAC,EAAI,CAAC,CAAC,CAC5D,KAAM,CAAAC,IAAY,CAAGF,MAAM,CAACP,YAAY,CAACQ,GAAG,CAAC,MAAM,CAAC,EAAI,CAAC,CAAC,CAC1D,KAAM,CAAAE,KAAa,CAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,IAAI,CAACT,YAAY,CAAGE,KAAK,CAAC,CAAC,CACjE,GAAI,CAAAQ,QAAkB,CAAG,EAAE,CAC3B,GAAIV,YAAY,CAAE,CAChBU,QAAQ,CAAG,CAAC,GAAGC,KAAK,CAACL,KAAK,CAAG,CAAC,CAAC,CAACM,IAAI,CAAC,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAClD,CACA,KAAM,CAAAC,IAAI,CAAGT,IAAI,CAAGC,KAAK,CAAGD,IAAI,CAAG,CAAC,CAAGA,IAAI,CAC3C,KAAM,CAAAU,QAAQ,CAAGV,IAAI,CAAG,CAAC,CAAGA,IAAI,CAAG,CAAC,CAAGA,IAAI,CAE3C,KAAM,CAAAW,eAAe,CAAIC,CAAsC,EAAK,CAClE,KAAM,CAAEC,IAAI,CAAEC,GAAG,CAAEC,EAAE,CAAEC,KAAM,CAAC,CAAGJ,CAAC,CAACK,aAAkC,CACrE,GAAI,CAAAC,MAAM,CAAGvC,WAAW,CAACwC,KAAK,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAEtD,GAAI,CAACJ,MAAM,CAACJ,GAAG,CAAC,CAAE,CAChB;AACAI,MAAM,CAACJ,GAAG,CAAC,CAAGE,KAAK,CACrB,CAAC,IAAM,IAAIA,KAAK,GAAKE,MAAM,CAACJ,GAAG,CAAC,CAAE,CAChC;AACA;AACA,MAAO,CAAAI,MAAM,CAACJ,GAAG,CAAC,CAClBI,MAAM,CAACJ,GAAG,CAAC,CAAGE,KAAK,CACrB,CAEA,KAAM,CAAAO,WAAW,CAAG5C,WAAW,CAAC6C,SAAS,CAACN,MAAM,CAAC,CACjD1B,eAAe,CAAC+B,WAAW,CAAC,CAC5BH,MAAM,CAACK,QAAQ,CAAC,CAAEC,GAAG,CAAE,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CACjD,CAAC,CAED,KAAM,CAAAC,SAAS,CAAIhB,CAAsC,EAAK,CAC5D,KAAM,CAAEC,IAAI,CAAEC,GAAG,CAAEC,EAAE,CAAEC,KAAM,CAAC,CAAGJ,CAAC,CAACK,aAAkC,CACrE,GAAI,CAAAC,MAAM,CAAGvC,WAAW,CAACwC,KAAK,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAEtD,GAAI,CAACJ,MAAM,CAACJ,GAAG,CAAC,CAAE,CAChB;AACAI,MAAM,CAACJ,GAAG,CAAC,CAAGE,KAAK,CACrB,CAAC,IAAM,IAAIF,GAAG,GAAI,CAAAI,MAAM,EAAIF,KAAK,GAAKE,MAAM,CAACJ,GAAG,CAAC,CAAE,CACjD;AACA,MAAO,CAAAI,MAAM,CAACJ,GAAG,CAAC,CACpB,CAAC,IAAM,IAAIE,KAAK,GAAKE,MAAM,CAACJ,GAAG,CAAC,CAAE,CAChC;AACA;AACAI,MAAM,CAACJ,GAAG,CAAC,CAAGE,KAAK,CACrB,CACA,MAAO,CAAAE,MAAM,CAAC,MAAM,CAAC,CAErB,KAAM,CAAAK,WAAW,CAAG5C,WAAW,CAAC6C,SAAS,CAACN,MAAM,CAAC,CACjD1B,eAAe,CAAC+B,WAAW,CAAC,CAC9B,CAAC,CAED,KAAM,CAAAM,YAAY,CAAIjB,CAAsC,EAAK,CAC/D,KAAM,CAAEC,IAAI,CAAEC,GAAG,CAAEC,EAAE,CAAEC,KAAM,CAAC,CAAGJ,CAAC,CAACK,aAAkC,CACrE,GAAI,CAAAC,MAAM,CAAGvC,WAAW,CAACwC,KAAK,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAEtD,GAAI,CAAChB,KAAK,CAACwB,OAAO,CAACZ,MAAM,CAACa,OAAO,CAAC,CAAE,CAClCb,MAAM,CAACa,OAAO,CAAG,CAACb,MAAM,CAACa,OAAO,CAAC,CACnC,CAEA,GAAI,CAACb,MAAM,CAACJ,GAAG,CAAC,CAAE,CAChB;AACAI,MAAM,CAACJ,GAAG,CAAC,CAAGE,KAAK,CACrB,CAAC,IAAM,IAAIF,GAAG,GAAI,CAAAI,MAAM,EAAIF,KAAK,GAAKE,MAAM,CAACJ,GAAG,CAAC,CAAE,CACjD;AACA,MAAO,CAAAI,MAAM,CAACJ,GAAG,CAAC,CACpB,CAAC,IAAM,IAAI,CAACI,MAAM,CAACa,OAAO,CAACC,QAAQ,CAAChB,KAAK,CAAC,CAAE,CAC1CE,MAAM,CAACa,OAAO,CAACE,IAAI,CAACjB,KAAK,CAAC,CAC5B,CAAC,IAAM,IAAIE,MAAM,CAACa,OAAO,CAACC,QAAQ,CAAChB,KAAK,CAAC,CAAE,CACzCE,MAAM,CAACa,OAAO,CAAGb,MAAM,CAACa,OAAO,CAAEG,MAAM,CAAEC,OAAY,EAAK,CACxD,MAAO,CAAAA,OAAO,GAAKnB,KAAK,CAC1B,CAAC,CAAC,CACJ,CACA,MAAO,CAAAE,MAAM,CAAC,MAAM,CAAC,CAErB,KAAM,CAAAK,WAAW,CAAG5C,WAAW,CAAC6C,SAAS,CAACN,MAAM,CAAC,CACjD1B,eAAe,CAAC+B,WAAW,CAAC,CAC9B,CAAC,CAED,mBACElC,KAAA,QAAK+C,SAAS,CAAE,wBAAyB,CAAAC,QAAA,eACvClD,IAAA,CAACJ,SAAS,EACRW,UAAU,CAAEA,UAAW,CACvBkC,SAAS,CAAEA,SAAU,CACrBC,YAAY,CAAEA,YAAa,CAC5B,CAAC,cAEF1C,IAAA,OAAIiD,SAAS,CAAC,6DAA6D,CAAAC,QAAA,CACxE5C,IAAI,CAAC6C,IAAI,CAACC,MAAM,GAAK,CAAC,CACrB9C,IAAI,CAAC6C,IAAI,CAACE,GAAG,CAAEC,GAAY,eACzBtD,IAAA,CAACH,OAAO,EAEN+C,OAAO,CAAEU,GAAG,CAACV,OAAQ,CACrBW,GAAG,CAAED,GAAG,CAACC,GAAI,CACb7B,IAAI,CAAE4B,GAAG,CAAC5B,IAAK,CACf8B,GAAG,CAAEF,GAAG,CAACE,GAAI,CACbC,KAAK,CAAEH,GAAG,CAACG,KAAM,CACjBC,MAAM,CAAEJ,GAAG,CAACI,MAAO,CACnBC,GAAG,CAAEL,GAAG,CAACK,GAAI,CACbC,eAAe,CAAEN,GAAG,CAACM,eAAgB,EARhCN,GAAG,CAACC,GASV,CACF,CAAC,cAEFvD,IAAA,QAAKiD,SAAS,CAAC,mCAAmC,CAAAC,QAAA,cAChDlD,IAAA,OAAIiD,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAAC,sDAEjC,CAAI,CAAC,CACF,CACN,CACC,CAAC,cAELlD,IAAA,QAAKiD,SAAS,CAAC,YAAY,CAAAC,QAAA,cACzBlD,IAAA,CAACF,UAAU,EACToB,QAAQ,CAAEA,QAAS,CACnBI,IAAI,CAAEA,IAAK,CACXC,QAAQ,CAAEA,QAAS,CACnBC,eAAe,CAAEA,eAAgB,CAClC,CAAC,CACC,CAAC,EACH,CAAC,CAEV,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _slicedToArray from\"E:/MERN/backend/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useContext,useEffect,useMemo,useState}from\"react\";import{useNavigate,useLocation}from\"react-router-dom\";import{registerUser,loginUser,logoutUser,getUser}from\"../../services/api\";import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=/*#__PURE__*/createContext({});// Export the provider as we need to wrap the entire app with it\nexport function AuthProvider(_ref){var children=_ref.children;var _useState=useState(),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),loadingInitial=_useState10[0],setLoadingInitial=_useState10[1];var navigate=useNavigate();var location=useLocation();useEffect(function(){if(error)setError(null);},[location.pathname]);useEffect(function(){getUser().then(function(data){setUser(data.user);}).catch(function(_error){}).finally(function(){return setLoadingInitial(false);});},[]);var register=function register(user){setLoading(true);setError(undefined);registerUser(user).then(function(data){setUser(data.user);setMessage(data.message);setTimeout(function(){setMessage(undefined);navigate(\"/users/login\");},2000);}).catch(function(err){return setError(err);}).finally(function(){return setLoading(false);});};var login=function login(user){setLoading(true);setError(undefined);loginUser(user).then(function(data){setUser(data.user);setMessage(data.message);setTimeout(function(){setMessage(undefined);navigate(\"/users/my-account\");},2000);}).catch(function(err){return setError(err);}).finally(function(){return setLoading(false);});};var logout=function logout(){logoutUser().then(function(data){setUser(undefined);setMessage(data.message);setTimeout(function(){setMessage(undefined);navigate(\"/\");},2000);});};var memoedValue=useMemo(function(){return{user:user,message:message,error:error,loading:loading,register:register,login:login,logout:logout};},[user,message,error,loading]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:memoedValue,children:!loadingInitial&&children});}export default function useAuth(){return useContext(AuthContext);}","map":{"version":3,"names":["createContext","useContext","useEffect","useMemo","useState","useNavigate","useLocation","registerUser","loginUser","logoutUser","getUser","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","message","setMessage","_useState5","_useState6","error","setError","_useState7","_useState8","loading","setLoading","_useState9","_useState10","loadingInitial","setLoadingInitial","navigate","location","pathname","then","data","catch","_error","finally","register","undefined","setTimeout","err","login","logout","memoedValue","Provider","value","useAuth"],"sources":["E:/MERN/backend/client/src/context/userContext/useAuth.tsx"],"sourcesContent":["import {\n  createContext,\n  ReactNode,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport {\n  registerUser,\n  loginUser,\n  logoutUser,\n  getUser,\n} from \"../../services/api\";\n\nconst AuthContext = createContext<AuthContextType>({} as AuthContextType);\n\n// Export the provider as we need to wrap the entire app with it\nexport function AuthProvider({\n  children,\n}: {\n  children: ReactNode;\n}): JSX.Element {\n  const [user, setUser] = useState<User>();\n  const [message, setMessage] = useState<AuthMessage>();\n  const [error, setError] = useState<any>();\n  const [loading, setLoading] = useState<boolean>(false);\n  const [loadingInitial, setLoadingInitial] = useState<boolean>(true);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  useEffect(() => {\n    if (error) setError(null);\n  }, [location.pathname]);\n\n  useEffect(() => {\n    getUser()\n      .then((data) => {\n        setUser(data.user);\n      })\n      .catch((_error) => {})\n      .finally(() => setLoadingInitial(false));\n  }, []);\n\n  const register = (user: RegisterUser) => {\n    setLoading(true);\n    setError(undefined);\n    registerUser(user)\n      .then((data) => {\n        setUser(data.user);\n        setMessage(data.message);\n        setTimeout(() => {\n          setMessage(undefined);\n          navigate(\"/users/login\");\n        }, 2000);\n      })\n      .catch((err) => setError(err))\n      .finally(() => setLoading(false));\n  };\n\n  const login = (user: LoginUser) => {\n    setLoading(true);\n    setError(undefined);\n    loginUser(user)\n      .then((data) => {\n        setUser(data.user);\n        setMessage(data.message);\n        setTimeout(() => {\n          setMessage(undefined);\n          navigate(\"/users/my-account\");\n        }, 2000);\n      })\n      .catch((err) => setError(err))\n      .finally(() => setLoading(false));\n  };\n\n  const logout = () => {\n    logoutUser().then((data) => {\n      setUser(undefined);\n      setMessage(data.message);\n      setTimeout(() => {\n        setMessage(undefined);\n        navigate(\"/\");\n      }, 2000);\n    });\n  };\n\n  const memoedValue = useMemo(\n    () => ({\n      user,\n      message,\n      error,\n      loading,\n      register,\n      login,\n      logout,\n    }),\n    [user, message, error, loading]\n  );\n\n  return (\n    <AuthContext.Provider value={memoedValue}>\n      {!loadingInitial && children}\n    </AuthContext.Provider>\n  );\n}\n\nexport default function useAuth() {\n  return useContext(AuthContext);\n}\n"],"mappings":"4GAAA,OACEA,aAAa,CAEbC,UAAU,CACVC,SAAS,CACTC,OAAO,CACPC,QAAQ,KACH,OAAO,CACd,OAASC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CAC3D,OACEC,YAAY,CACZC,SAAS,CACTC,UAAU,CACVC,OAAO,KACF,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE5B,GAAM,CAAAC,WAAW,cAAGb,aAAa,CAAkB,CAAC,CAAoB,CAAC,CAEzE;AACA,MAAO,SAAS,CAAAc,YAAYA,CAAAC,IAAA,CAIZ,IAHd,CAAAC,QAAQ,CAAAD,IAAA,CAARC,QAAQ,CAIR,IAAAC,SAAA,CAAwBb,QAAQ,CAAO,CAAC,CAAAc,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAjCG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IACpB,IAAAI,UAAA,CAA8BlB,QAAQ,CAAc,CAAC,CAAAmB,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA9CE,OAAO,CAAAD,UAAA,IAAEE,UAAU,CAAAF,UAAA,IAC1B,IAAAG,UAAA,CAA0BtB,QAAQ,CAAM,CAAC,CAAAuB,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAAlCE,KAAK,CAAAD,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IACtB,IAAAG,UAAA,CAA8B1B,QAAQ,CAAU,KAAK,CAAC,CAAA2B,UAAA,CAAAZ,cAAA,CAAAW,UAAA,IAA/CE,OAAO,CAAAD,UAAA,IAAEE,UAAU,CAAAF,UAAA,IAC1B,IAAAG,UAAA,CAA4C9B,QAAQ,CAAU,IAAI,CAAC,CAAA+B,WAAA,CAAAhB,cAAA,CAAAe,UAAA,IAA5DE,cAAc,CAAAD,WAAA,IAAEE,iBAAiB,CAAAF,WAAA,IACxC,GAAM,CAAAG,QAAQ,CAAGjC,WAAW,CAAC,CAAC,CAC9B,GAAM,CAAAkC,QAAQ,CAAGjC,WAAW,CAAC,CAAC,CAE9BJ,SAAS,CAAC,UAAM,CACd,GAAI0B,KAAK,CAAEC,QAAQ,CAAC,IAAI,CAAC,CAC3B,CAAC,CAAE,CAACU,QAAQ,CAACC,QAAQ,CAAC,CAAC,CAEvBtC,SAAS,CAAC,UAAM,CACdQ,OAAO,CAAC,CAAC,CACN+B,IAAI,CAAC,SAACC,IAAI,CAAK,CACdrB,OAAO,CAACqB,IAAI,CAACtB,IAAI,CAAC,CACpB,CAAC,CAAC,CACDuB,KAAK,CAAC,SAACC,MAAM,CAAK,CAAC,CAAC,CAAC,CACrBC,OAAO,CAAC,iBAAM,CAAAR,iBAAiB,CAAC,KAAK,CAAC,GAAC,CAC5C,CAAC,CAAE,EAAE,CAAC,CAEN,GAAM,CAAAS,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAI1B,IAAkB,CAAK,CACvCa,UAAU,CAAC,IAAI,CAAC,CAChBJ,QAAQ,CAACkB,SAAS,CAAC,CACnBxC,YAAY,CAACa,IAAI,CAAC,CACfqB,IAAI,CAAC,SAACC,IAAI,CAAK,CACdrB,OAAO,CAACqB,IAAI,CAACtB,IAAI,CAAC,CAClBK,UAAU,CAACiB,IAAI,CAAClB,OAAO,CAAC,CACxBwB,UAAU,CAAC,UAAM,CACfvB,UAAU,CAACsB,SAAS,CAAC,CACrBT,QAAQ,CAAC,cAAc,CAAC,CAC1B,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAC,CACDK,KAAK,CAAC,SAACM,GAAG,QAAK,CAAApB,QAAQ,CAACoB,GAAG,CAAC,GAAC,CAC7BJ,OAAO,CAAC,iBAAM,CAAAZ,UAAU,CAAC,KAAK,CAAC,GAAC,CACrC,CAAC,CAED,GAAM,CAAAiB,KAAK,CAAG,QAAR,CAAAA,KAAKA,CAAI9B,IAAe,CAAK,CACjCa,UAAU,CAAC,IAAI,CAAC,CAChBJ,QAAQ,CAACkB,SAAS,CAAC,CACnBvC,SAAS,CAACY,IAAI,CAAC,CACZqB,IAAI,CAAC,SAACC,IAAI,CAAK,CACdrB,OAAO,CAACqB,IAAI,CAACtB,IAAI,CAAC,CAClBK,UAAU,CAACiB,IAAI,CAAClB,OAAO,CAAC,CACxBwB,UAAU,CAAC,UAAM,CACfvB,UAAU,CAACsB,SAAS,CAAC,CACrBT,QAAQ,CAAC,mBAAmB,CAAC,CAC/B,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAC,CACDK,KAAK,CAAC,SAACM,GAAG,QAAK,CAAApB,QAAQ,CAACoB,GAAG,CAAC,GAAC,CAC7BJ,OAAO,CAAC,iBAAM,CAAAZ,UAAU,CAAC,KAAK,CAAC,GAAC,CACrC,CAAC,CAED,GAAM,CAAAkB,MAAM,CAAG,QAAT,CAAAA,MAAMA,CAAA,CAAS,CACnB1C,UAAU,CAAC,CAAC,CAACgC,IAAI,CAAC,SAACC,IAAI,CAAK,CAC1BrB,OAAO,CAAC0B,SAAS,CAAC,CAClBtB,UAAU,CAACiB,IAAI,CAAClB,OAAO,CAAC,CACxBwB,UAAU,CAAC,UAAM,CACfvB,UAAU,CAACsB,SAAS,CAAC,CACrBT,QAAQ,CAAC,GAAG,CAAC,CACf,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAC,CACJ,CAAC,CAED,GAAM,CAAAc,WAAW,CAAGjD,OAAO,CACzB,iBAAO,CACLiB,IAAI,CAAJA,IAAI,CACJI,OAAO,CAAPA,OAAO,CACPI,KAAK,CAALA,KAAK,CACLI,OAAO,CAAPA,OAAO,CACPc,QAAQ,CAARA,QAAQ,CACRI,KAAK,CAALA,KAAK,CACLC,MAAM,CAANA,MACF,CAAC,EAAC,CACF,CAAC/B,IAAI,CAAEI,OAAO,CAAEI,KAAK,CAAEI,OAAO,CAChC,CAAC,CAED,mBACEpB,IAAA,CAACC,WAAW,CAACwC,QAAQ,EAACC,KAAK,CAAEF,WAAY,CAAApC,QAAA,CACtC,CAACoB,cAAc,EAAIpB,QAAQ,CACR,CAAC,CAE3B,CAEA,cAAe,SAAS,CAAAuC,OAAOA,CAAA,CAAG,CAChC,MAAO,CAAAtD,UAAU,CAACY,WAAW,CAAC,CAChC"},"metadata":{},"sourceType":"module","externalDependencies":[]}
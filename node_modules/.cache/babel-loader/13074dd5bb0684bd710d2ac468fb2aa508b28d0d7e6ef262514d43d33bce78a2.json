{"ast":null,"code":"import _toConsumableArray from\"E:/MERN/backend/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"E:/MERN/backend/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import queryString from\"query-string\";import{useEffect}from\"react\";import{useLoaderData,useSearchParams}from\"react-router-dom\";import{SearchBar}from\"./searchBar\";import{PetCard}from\"./petCard\";import{Pagination}from\"./pagination\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var PetSearchPage=function PetSearchPage(){var _useSearchParams=useSearchParams(),_useSearchParams2=_slicedToArray(_useSearchParams,2),searchParams=_useSearchParams2[0],setSearchParams=_useSearchParams2[1];var pets=useLoaderData();useEffect(function(){setSearchParams(searchParams);},[searchParams,setSearchParams]);var clearQuery=function clearQuery(){return setSearchParams({});};//Pagination data.\nvar resultsCount=pets.totalPetsResults;var limit=Number(searchParams.get(\"limit\")||6);var page=Number(searchParams.get(\"page\")||1);var pages=Math.trunc(Math.ceil(resultsCount/limit));var pageList=[];if(resultsCount){pageList=_toConsumableArray(Array(pages+1).keys()).slice(1);}var next=page<pages?page+1:page;var previous=page>1?page-1:page;var paginationQuery=function paginationQuery(e){var _ref=e.currentTarget,key=_ref.name,value=_ref.id;var parsed=queryString.parse(window.location.search);if(!parsed[key]){//No key present in current search params, set search params.\nparsed[key]=value;}else if(value!==parsed[key]){//Key present but value is new in current search params,\n//update params value.\ndelete parsed[key];parsed[key]=value;}var stringified=queryString.stringify(parsed);setSearchParams(stringified);window.scrollTo({top:0,behavior:\"smooth\"});};var sortQuery=function sortQuery(e){var _ref2=e.currentTarget,key=_ref2.name,value=_ref2.id;var parsed=queryString.parse(window.location.search);if(!parsed[key]){//No key present in current search params, set search params.\nparsed[key]=value;}else if(key in parsed&&value===parsed[key]){//Key and value match current search params, delete search params from query.\ndelete parsed[key];}else if(value!==parsed[key]){//Key present but value is new in current search params,\n//update params value.\nparsed[key]=value;}delete parsed[\"page\"];var stringified=queryString.stringify(parsed);setSearchParams(stringified);};var speciesQuery=function speciesQuery(e){var _ref3=e.currentTarget,key=_ref3.name,value=_ref3.id;var parsed=queryString.parse(window.location.search);if(!Array.isArray(parsed.species)){parsed.species=[parsed.species];}if(!parsed[key]){//No key present in current search params, append sort search params.\nparsed[key]=value;}else if(key in parsed&&value===parsed[key]){//Key and value match current sort search params, remove sort search params.\ndelete parsed[key];}else if(!parsed.species.includes(value)){parsed.species.push(value);}else if(parsed.species.includes(value)){parsed.species=parsed.species.filter(function(element){return element!==value;});}delete parsed[\"page\"];var stringified=queryString.stringify(parsed);setSearchParams(stringified);};return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4\",children:[/*#__PURE__*/_jsx(SearchBar,{clearQuery:clearQuery,sortQuery:sortQuery,speciesQuery:speciesQuery}),/*#__PURE__*/_jsx(\"ul\",{className:\"flex flex-row flex-wrap justify-evenly gap-x-1 gap-y-7 my-5\",children:pets.data.length!==0?pets.data.map(function(pet){return/*#__PURE__*/_jsx(PetCard,{species:pet.species,_id:pet._id,name:pet.name,fee:pet.fee,image:pet.image,gender:pet.gender,age:pet.age,dateAddedToSite:pet.dateAddedToSite},pet._id);}):/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col justify-center my-4\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"text-center mb-4\",children:\"Woof... We're having trouble finding pets right now.\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex my-20\",children:/*#__PURE__*/_jsx(Pagination,{pageList:pageList,next:next,previous:previous,paginationQuery:paginationQuery})})]});};","map":{"version":3,"names":["queryString","useEffect","useLoaderData","useSearchParams","SearchBar","PetCard","Pagination","jsx","_jsx","jsxs","_jsxs","PetSearchPage","_useSearchParams","_useSearchParams2","_slicedToArray","searchParams","setSearchParams","pets","clearQuery","resultsCount","totalPetsResults","limit","Number","get","page","pages","Math","trunc","ceil","pageList","_toConsumableArray","Array","keys","slice","next","previous","paginationQuery","e","_ref","currentTarget","key","name","value","id","parsed","parse","window","location","search","stringified","stringify","scrollTo","top","behavior","sortQuery","_ref2","speciesQuery","_ref3","isArray","species","includes","push","filter","element","className","children","data","length","map","pet","_id","fee","image","gender","age","dateAddedToSite"],"sources":["E:/MERN/backend/client/src/components/petSearch/petSearchPage.tsx"],"sourcesContent":["import queryString from \"query-string\";\nimport { useEffect } from \"react\";\nimport { useLoaderData, useSearchParams } from \"react-router-dom\";\nimport { SearchBar } from \"./searchBar\";\nimport { PetCard } from \"./petCard\";\nimport { Pagination } from \"./pagination\";\n\nexport const PetSearchPage: Function = () => {\n  let [searchParams, setSearchParams] = useSearchParams();\n\n  const pets = useLoaderData() as PetData;\n\n  useEffect(() => {\n    setSearchParams(searchParams);\n  }, [searchParams, setSearchParams]);\n\n  const clearQuery: React.MouseEventHandler = () => {\n    return setSearchParams({});\n  };\n\n  //Pagination data.\n  const resultsCount = pets.totalPetsResults;\n  const limit: number = Number(searchParams.get(\"limit\") || 6);\n  const page: number = Number(searchParams.get(\"page\") || 1);\n  const pages: number = Math.trunc(Math.ceil(resultsCount / limit));\n  let pageList: number[] = [];\n  if (resultsCount) {\n    pageList = [...Array(pages + 1).keys()].slice(1);\n  }\n  const next = page < pages ? page + 1 : page;\n  const previous = page > 1 ? page - 1 : page;\n\n  const paginationQuery = (e: React.MouseEvent<HTMLButtonElement>) => {\n    const { name: key, id: value } = e.currentTarget as HTMLButtonElement;\n    let parsed = queryString.parse(window.location.search);\n\n    if (!parsed[key]) {\n      //No key present in current search params, set search params.\n      parsed[key] = value;\n    } else if (value !== parsed[key]) {\n      //Key present but value is new in current search params,\n      //update params value.\n      delete parsed[key];\n      parsed[key] = value;\n    }\n\n    const stringified = queryString.stringify(parsed);\n    setSearchParams(stringified);\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  };\n\n  const sortQuery = (e: React.MouseEvent<HTMLButtonElement>) => {\n    const { name: key, id: value } = e.currentTarget as HTMLButtonElement;\n    let parsed = queryString.parse(window.location.search);\n\n    if (!parsed[key]) {\n      //No key present in current search params, set search params.\n      parsed[key] = value;\n    } else if (key in parsed && value === parsed[key]) {\n      //Key and value match current search params, delete search params from query.\n      delete parsed[key];\n    } else if (value !== parsed[key]) {\n      //Key present but value is new in current search params,\n      //update params value.\n      parsed[key] = value;\n    }\n    delete parsed[\"page\"];\n\n    const stringified = queryString.stringify(parsed);\n    setSearchParams(stringified);\n  };\n\n  const speciesQuery = (e: React.MouseEvent<HTMLButtonElement>) => {\n    const { name: key, id: value } = e.currentTarget as HTMLButtonElement;\n    let parsed = queryString.parse(window.location.search);\n\n    if (!Array.isArray(parsed.species)) {\n      parsed.species = [parsed.species];\n    }\n\n    if (!parsed[key]) {\n      //No key present in current search params, append sort search params.\n      parsed[key] = value;\n    } else if (key in parsed && value === parsed[key]) {\n      //Key and value match current sort search params, remove sort search params.\n      delete parsed[key];\n    } else if (!parsed.species.includes(value)) {\n      parsed.species.push(value);\n    } else if (parsed.species.includes(value)) {\n      parsed.species = parsed.species!.filter((element: any) => {\n        return element !== value;\n      });\n    }\n    delete parsed[\"page\"];\n\n    const stringified = queryString.stringify(parsed);\n    setSearchParams(stringified);\n  };\n\n  return (\n    <div className={\"container mx-auto px-4\"}>\n      <SearchBar\n        clearQuery={clearQuery}\n        sortQuery={sortQuery}\n        speciesQuery={speciesQuery}\n      />\n\n      <ul className=\"flex flex-row flex-wrap justify-evenly gap-x-1 gap-y-7 my-5\">\n        {pets.data.length !== 0 ? (\n          pets.data.map((pet: PetCard) => (\n            <PetCard\n              key={pet._id}\n              species={pet.species}\n              _id={pet._id}\n              name={pet.name}\n              fee={pet.fee}\n              image={pet.image}\n              gender={pet.gender}\n              age={pet.age}\n              dateAddedToSite={pet.dateAddedToSite}\n            />\n          ))\n        ) : (\n          <div className=\"flex flex-col justify-center my-4\">\n            <h3 className=\"text-center mb-4\">\n              Woof... We're having trouble finding pets right now.\n            </h3>\n          </div>\n        )}\n      </ul>\n\n      <div className=\"flex my-20\">\n        <Pagination\n          pageList={pageList}\n          next={next}\n          previous={previous}\n          paginationQuery={paginationQuery}\n        />\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import{createContext,useContext,useEffect,useMemo,useState}from\"react\";import{useNavigate,useLocation}from\"react-router-dom\";import{registerUser,loginUser,logoutUser,getUser}from\"../../services/api\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext({});// Export the provider as we need to wrap the entire app with it\nexport function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState();const[message,setMessage]=useState();const[error,setError]=useState();const[loading,setLoading]=useState(false);const[loadingInitial,setLoadingInitial]=useState(true);const navigate=useNavigate();const location=useLocation();useEffect(()=>{if(error)setError(null);},[location.pathname]);useEffect(()=>{getUser().then(data=>{setUser(data.user);}).catch(_error=>{}).finally(()=>setLoadingInitial(false));},[]);const register=user=>{setLoading(true);setError(undefined);registerUser(user).then(data=>{setUser(data.user);setMessage(data.message);setTimeout(()=>{setMessage(undefined);navigate(\"/users/login\");},2000);}).catch(err=>setError(err)).finally(()=>setLoading(false));};const login=user=>{setLoading(true);setError(undefined);loginUser(user).then(data=>{setUser(data.user);setMessage(data.message);setTimeout(()=>{setMessage(undefined);navigate(\"/users/my-account\");},2000);}).catch(err=>setError(err)).finally(()=>setLoading(false));};const logout=()=>{logoutUser().then(data=>{setUser(undefined);setMessage(data.message);setTimeout(()=>{setMessage(undefined);navigate(\"/\");},2000);});};const memoedValue=useMemo(()=>({user,message,error,loading,register,login,logout}),[user,message,error,loading]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:memoedValue,children:!loadingInitial&&children});}export default function useAuth(){return useContext(AuthContext);}","map":{"version":3,"names":["createContext","useContext","useEffect","useMemo","useState","useNavigate","useLocation","registerUser","loginUser","logoutUser","getUser","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","message","setMessage","error","setError","loading","setLoading","loadingInitial","setLoadingInitial","navigate","location","pathname","then","data","catch","_error","finally","register","undefined","setTimeout","err","login","logout","memoedValue","Provider","value","useAuth"],"sources":["E:/MERN/backend/client/src/context/userContext/useAuth.tsx"],"sourcesContent":["import {\n  createContext,\n  ReactNode,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport {\n  registerUser,\n  loginUser,\n  logoutUser,\n  getUser,\n} from \"../../services/api\";\n\nconst AuthContext = createContext<AuthContextType>({} as AuthContextType);\n\n// Export the provider as we need to wrap the entire app with it\nexport function AuthProvider({\n  children,\n}: {\n  children: ReactNode;\n}): JSX.Element {\n  const [user, setUser] = useState<User>();\n  const [message, setMessage] = useState<AuthMessage>();\n  const [error, setError] = useState<any>();\n  const [loading, setLoading] = useState<boolean>(false);\n  const [loadingInitial, setLoadingInitial] = useState<boolean>(true);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  useEffect(() => {\n    if (error) setError(null);\n  }, [location.pathname]);\n\n  useEffect(() => {\n    getUser()\n      .then((data) => {\n        setUser(data.user);\n      })\n      .catch((_error) => {})\n      .finally(() => setLoadingInitial(false));\n  }, []);\n\n  const register = (user: RegisterUser) => {\n    setLoading(true);\n    setError(undefined);\n    registerUser(user)\n      .then((data) => {\n        setUser(data.user);\n        setMessage(data.message);\n        setTimeout(() => {\n          setMessage(undefined);\n          navigate(\"/users/login\");\n        }, 2000);\n      })\n      .catch((err) => setError(err))\n      .finally(() => setLoading(false));\n  };\n\n  const login = (user: LoginUser) => {\n    setLoading(true);\n    setError(undefined);\n    loginUser(user)\n      .then((data) => {\n        setUser(data.user);\n        setMessage(data.message);\n        setTimeout(() => {\n          setMessage(undefined);\n          navigate(\"/users/my-account\");\n        }, 2000);\n      })\n      .catch((err) => setError(err))\n      .finally(() => setLoading(false));\n  };\n\n  const logout = () => {\n    logoutUser().then((data) => {\n      setUser(undefined);\n      setMessage(data.message);\n      setTimeout(() => {\n        setMessage(undefined);\n        navigate(\"/\");\n      }, 2000);\n    });\n  };\n\n  const memoedValue = useMemo(\n    () => ({\n      user,\n      message,\n      error,\n      loading,\n      register,\n      login,\n      logout,\n    }),\n    [user, message, error, loading]\n  );\n\n  return (\n    <AuthContext.Provider value={memoedValue}>\n      {!loadingInitial && children}\n    </AuthContext.Provider>\n  );\n}\n\nexport default function useAuth() {\n  return useContext(AuthContext);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}